{% extends "page.html" %}
{% block body %}

<body class="grey lighten-3 animated fadeIn">

  <!--Main Navigation-->
  <header>

    <!-- Navbar -->
    <nav class="navbar fixed-top navbar-expand-lg navbar-dark blue scrolling-navbar">
      <div class="container-fluid">

        <!-- Brand -->
        <a class="navbar-brand waves-effect" href="https://mdbootstrap.com/docs/jquery/" target="_blank">
          <strong class="blue-text">MDB</strong>
        </a>

        <!-- Collapse -->
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Links -->
        <div class="collapse navbar-collapse" id="navbarSupportedContent">

          
          <ul class="navbar-nav mr-auto"><!-- Left 
            <li class="nav-item active">
              <a class="nav-link waves-effect" href="#">Home
                <span class="sr-only">(current)</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link waves-effect" href="https://mdbootstrap.com/docs/jquery/" target="_blank">About
                MDB</a>
            </li>
            <li class="nav-item">
              <a class="nav-link waves-effect" href="https://mdbootstrap.com/docs/jquery/getting-started/download/"
                target="_blank">Free
                download</a>
            </li>
            <li class="nav-item">
              <a class="nav-link waves-effect" href="https://mdbootstrap.com/education/bootstrap/" target="_blank">Free
                tutorials</a>
            </li>-->
          </ul>

          <!-- Right -->
          <ul class="navbar-nav nav-flex-icons float-right">
            <li class="nav-item">
              <a href="https://www.facebook.com/mdbootstrap" class="nav-link waves-effect" target="_blank">
                <i class="fas fa-user mr-1"></i> mailmail@email.com
              </a>
            </li>
            
          </ul>

        </div>

      </div>
    </nav>
    <!-- Navbar -->

    <!-- Sidebar -->
    <div class="sidebar-fixed position-fixed stylish-color">

      <a class="logo-wrapper waves-effect">
        <img src="https://mdbootstrap.com/img/logo/mdb-email.png" class="img-fluid" alt="">
      </a>

      <div class="list-group list-group-flush">
        <a href="/" class="list-group-item list-group-item-action stylish-color text-white waves-effect">
          <i class="fas fa-camera mr-3"></i>Cámaras
        </a>
        <a href="#" class="list-group-item list-group-item-action stylish-color text-white waves-effect">
          <i class="fas fa-bell mr-3"></i>Notificaciones</a>
        <a href="/people" class="list-group-item active waves-effect">
          <i class="fas fa-users mr-3"></i>Personas</a>
        <a href="#" class="list-group-item list-group-item-action stylish-color text-white  waves-effect">
          <i class="fas fa-user-circle mr-3"></i>Detecciones</a>
        <a href="#" class="list-group-item list-group-item-action stylish-color text-white  waves-effect">
          <i class="fas fa-cog mr-3"></i>Configuración</a>
      </div>

    </div>
    <!-- Sidebar -->

  </header>
  <!--Main Navigation-->

  <!--Main layout-->
  <main class="pt-5">
    <div class="container-fluid mt-5">

      <!-- Heading -->
      <div class="card mb-4 wow fadeIn border-left-blue">

        <!--Card content-->
        <div class="card-body d-sm-flex justify-content-between">

          <h5 class="mb-2 mb-sm-0 pt-1">
            <span class="blue-text">Agregar Persona</span>
          </h5>

          <div class="d-flex justify-content-center">
            <a href="#update-model" class="boton-redondeado" onclick="update_model()"><i class="fas fa-sync"></i> Actualizar Model</a>
          </div>

        </div>

      </div>
      <!-- Heading -->

    <!--Grid row-->
    <div class="row wow mb-4  fadeIn">
      {% for camera in cameras %}
      <div class="col-md-4 mb-4">
        <!--Card-->
        <div class="card z-depth-0">
          <div class="card-header elegant-color m-0 p-0">
            <img style="border: none" class="m-0 p-0 img-thumbnail panel panel-default" id="0" src="{{ url_for('video_streamer2', id = camera.id) }}">
            <div class="position-absolute full-size blue p-1 text-white">
              <span>Full Size</span>  
            </div>

          </div>
          <!--Card content-->
          <div class="card-body border-left-blue">
            <h5 class="m-0">Camera {{ camera.id }}</h5>
          </div>

        </div>
        <!--/.Card-->
      </div>
      {% endfor %}

      <div class="col-md-4 mb-4">
        <!-- Default form login -->
        <form id="add-person" class="text-center">
          
            <input required type="text" name="name" id="name" class="form-control mb-4" placeholder="Nombre">
            <input required type="text" name="last_name" id="last_name" class="form-control mb-4" placeholder="Apellido">
            <input required type="text" name="piso" id="piso" class="form-control mb-4" placeholder="Piso">
            <input required type="text" name="departamento" id="departamento" class="form-control mb-4" placeholder="Departamento">
            <input required type="number" step="1" name="dni" id="dni" class="form-control mb-4" placeholder="DNI">
            <label for="camera">Seleccionar Cámara</label>
            <select required name="camera" id="camera" class="form-control" id="camera">
              {% for camera in cameras %}
              <option>{{ camera.id }}</option>
              {% endfor %}
            </select>
            
            <!-- Sign in button -->
            <button class="btn btn-info btn-block my-4 z-depth-0" type="submit">Capturar</button>


        </form>
        <!-- Default form login -->
      </div>


    </div>
    <!--Grid row-->


    <!-- Heading -->
    <div class="card mb-4 wow fadeIn border-left-blue">

      <!--Card content-->
      <div class="card-body d-sm-flex justify-content-between">

        <h5 class="mb-2 mb-sm-0 pt-1">
          <span class="blue-text">Ver personas</span>
        </h5>

        <div class="d-flex justify-content-center">
          
          <a href="#" class="boton-redondeado mr-3"><i class="fas fa-search-plus"></i> Ver todas</a>
          <a href="#get-personas" class="boton-redondeado" onclick="get_personas()"><i class="fas fa-sync"></i> Actualizar</a>
        </div>

      </div>

    </div>
    <!-- Heading -->
    <!--Grid row-->
    <div id="ver-personas" class="row wow mb-4  fadeIn">
      {% for persona in personas %}
      <div class="col-md-2 mb-4">
        <!--Card-->
        <div class="card z-depth-0">
          <div class="card-header elegant-color m-0 p-0">
            <img style="border: none" class="m-0 p-0 img-thumbnail panel panel-default" id="0" src="">
            <div class="position-absolute full-size blue p-1 text-white">
              <span>Full Size</span>  
            </div>

          </div>
          <!--Card content-->
          <div class="card-body border-left-blue">
            <h5 class="m-0">{{ persona.name }}</h5>
          </div>

        </div>
        <!--/.Card-->
      </div>
      {% endfor %}
    </div>

  </main>
  <!--Main layout-->

  <!--Footer-->
  <footer class="page-footer text-center font-small primary-color-dark darken-2 mt-4 wow fadeIn">

    <!--Call to action-->
    <div class="pt-4">
      <a class="btn btn-outline-white" href="https://mdbootstrap.com/docs/jquery/getting-started/download/" target="_blank"
        role="button">Download
        MDB
        <i class="fas fa-download ml-2"></i>
      </a>
      <a class="btn btn-outline-white" href="https://mdbootstrap.com/education/bootstrap/" target="_blank" role="button">Start
        free tutorial
        <i class="fas fa-graduation-cap ml-2"></i>
      </a>
    </div>
    <!--/.Call to action-->

    <hr class="my-4">

    

    <!--Copyright-->
    <div class="footer-copyright py-3">
      © 2019 Copyright:
      <a href="https://mdbootstrap.com/education/bootstrap/" target="_blank"> MDBootstrap.com </a>
    </div>
    <!--/.Copyright-->

  </footer>
  <!--/.Footer-->

  {% endblock %}
  {% block scripts %} 
  <script type="text/javascript" src="static/js/dashboard.js"></script>

  <!-- Initializations -->
  <script type="text/javascript">
    // Animations initialization
    new WOW().init();

  </script>

  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js"></script>
  <script>
    
    function show_personas(data){
      personas = JSON.parse(data)
      $("#ver-personas").children().remove();
      for (var i = 0; i < personas.length; i++){
        html = '<div class="col-md-2 mb-4"><div class="card z-depth-0"><div class="card-header elegant-color m-0 p-0"><img style="border: none" class="m-0 p-0 img-thumbnail panel panel-default" id="0" src=""></div>'
        html += '<div class="card-body border-left-blue"><h5 class="m-0">'+personas[i]["name"]+'</h5></div></div></div>'
        $("#ver-personas").append(html)
      }

    }
    function get_personas(){

      var url = "{{ url_for('get_people') }}";

      $.ajax({
        type: "GET",
        url: url,
        //data: form.serialize(),
        success: function(data){show_personas(data)},
        error: function(data){}
      }) 
    }


    function update_model(){

      var url = "{{ url_for('update_model') }}";

      $.ajax({
        type: "POST",
        url: url,
        //data: form.serialize(),
        success: function(data){console.log(data)},
        error: function(data){}
      }) 
    }

    $("#add-person").submit(function(e) {

      e.preventDefault();
      var form = $(this);
      var url = "{{ url_for('add_person_database') }}";

      $.ajax({
        type: "POST",
        url: url,
        data: form.serialize(),
        success: function(data){console.log(data)},
        error: function(data){}
      })  
    })
  </script>
{% endblock %}
</body>

</html>
